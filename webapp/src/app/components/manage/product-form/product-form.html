<div class="flex flex-col items-center px-40 mt-10">
   @if (id) {
      <h1 class="text-xl font-bold mb-4">Update Product</h1>
   } @else {
      <h1 class="text-xl font-bold mb-4">Add New Product</h1>
   }
    <form class="shadow p-4" [formGroup]="productForm">

    <div class="flex flex-wrap">

      <mat-form-field class="w-full">
         <mat-label>Category</mat-label>
         <mat-select formControlName ="categoryId">
           @for (item of categories; track $index) {
            <mat-option [value]="item._id">{{ item.name }}</mat-option>
           }
         </mat-select>
      </mat-form-field>

       <mat-form-field class="w-full">
         <mat-label>Brand</mat-label>
         <mat-select formControlName ="brandId" >
           @for (item of brands; track $index) {
            <mat-option [value]="item._id">{{ item.name }}</mat-option>
           }
            <mat-option [value]="">option1</mat-option>
         </mat-select>
      </mat-form-field>


        <mat-form-field class="w-full">
            <mat-label>Name</mat-label>
            <input matInput type="text" formControlName="name" />
         </mat-form-field>

         <mat-form-field class="w-full">
            <mat-label>Short Description</mat-label>
            <input matInput type="text" formControlName="shortDescription" />
         </mat-form-field>

         <mat-form-field class="w-full">
            <mat-label>Description</mat-label>
            <textarea matInput type="text" rows="5" formControlName="description" ></textarea>
         </mat-form-field>

         <mat-form-field class="w-full">
            <mat-label>Price</mat-label>
            <input matInput type="number" formControlName="price" />
         </mat-form-field>

         <mat-form-field class="w-full">
            <mat-label>Discount</mat-label>
            <input matInput type="number" formControlName="discount" />
         </mat-form-field>

         <div class="w-full flex gap-8">
            <mat-checkbox  formControlName="isFeatured">Is Featured</mat-checkbox>
            <mat-checkbox  formControlName="isNewProduct">Is New</mat-checkbox>
         </div>

         <div class="w-full flex flex-col" formArrayName="images">
            <div class="flex justify-between"><h4 class="mb-5">Images</h4>
               <button class="mb-3" mat-raised-button color="primary" (click)="addImage()"> Add Image </button>
               <button mat-raised-button color="primary" (click)="removeImage()"> Remove Image </button>

            </div>
           @for (item of images.controls; track $index) {
    <div class="mb-4">
      <label class="block mb-1 font-medium">Image {{$index + 1}}</label>
      <input type="file" accept="image/*" (change)="onFileSelected($event, $index)" class="block w-full border rounded px-2 py-1" />

      @if (imagePreviews[$index]) {
        <img [src]="imagePreviews[$index]" class="w-40 h-40 rounded-md border mt-2 object-cover" />
      }
    </div>
  }
         </div>

    </div>

    <div class="flex justify-center">
      @if (id) {
         <button mat-raised-button color="primary" [disabled]="productForm.invalid" (click)="updateProduct()">Update</button>

      } @else {

         <button mat-raised-button color="primary" [disabled]="productForm.invalid" (click)="addProduct()">Add</button>
      }
    </div>

    </form>
</div>